<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>回归分析第4讲——基于R语言实现线性回归 | 生信人的知识库</title><meta name="author" content="Redamancy"><meta name="copyright" content="Redamancy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="这一讲为实践内容，我们将学习如何使用R语言建立和拟合线性回归模型，并对模型和参数进行假设检验。 本讲默认读者已经了解R语言的基本语法，能够在自己的电脑中成功编写和运行R脚本。 一、线性回归的建立与解读 1.1 示例数据集介绍 本讲所使用的数据集是加拉帕戈斯群岛的物种数据，需要首先下载faraway包，并导入数据集gala： &gt; install.packages(&quot;faraway&amp;q">
<meta property="og:type" content="article">
<meta property="og:title" content="回归分析第4讲——基于R语言实现线性回归">
<meta property="og:url" content="https://cien-su.github.io/2025/10/28/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%E7%AC%AC4%E8%AE%B2%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8ER%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/index.html">
<meta property="og:site_name" content="生信人的知识库">
<meta property="og:description" content="这一讲为实践内容，我们将学习如何使用R语言建立和拟合线性回归模型，并对模型和参数进行假设检验。 本讲默认读者已经了解R语言的基本语法，能够在自己的电脑中成功编写和运行R脚本。 一、线性回归的建立与解读 1.1 示例数据集介绍 本讲所使用的数据集是加拉帕戈斯群岛的物种数据，需要首先下载faraway包，并导入数据集gala： &gt; install.packages(&quot;faraway&amp;q">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cien-su.github.io/img/avatar.png">
<meta property="article:published_time" content="2025-10-28T06:41:18.000Z">
<meta property="article:modified_time" content="2025-10-28T09:45:00.136Z">
<meta property="article:author" content="Redamancy">
<meta property="article:tag" content="R">
<meta property="article:tag" content="假设检验">
<meta property="article:tag" content="参数估计">
<meta property="article:tag" content="线性回归">
<meta property="article:tag" content="置信区间">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cien-su.github.io/img/avatar.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "回归分析第4讲——基于R语言实现线性回归",
  "url": "https://cien-su.github.io/2025/10/28/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%E7%AC%AC4%E8%AE%B2%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8ER%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/",
  "image": "https://cien-su.github.io/img/avatar.png",
  "datePublished": "2025-10-28T06:41:18.000Z",
  "dateModified": "2025-10-28T09:45:00.136Z",
  "author": [
    {
      "@type": "Person",
      "name": "Redamancy",
      "url": "https://cien-su.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://cien-su.github.io/2025/10/28/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%E7%AC%AC4%E8%AE%B2%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8ER%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"pagination":{"enable":true,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '回归分析第4讲——基于R语言实现线性回归',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-th"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/background.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">生信人的知识库</span></a><a class="nav-page-title" href="/"><span class="site-name">回归分析第4讲——基于R语言实现线性回归</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-th"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">回归分析第4讲——基于R语言实现线性回归</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-10-28T06:41:18.000Z" title="发表于 2025-10-28 14:41:18">2025-10-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-10-28T09:45:00.136Z" title="更新于 2025-10-28 17:45:00">2025-10-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/">回归分析</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">4.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>16分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>这一讲为实践内容，我们将学习如何使用R语言建立和拟合线性回归模型，并对模型和参数进行假设检验。</p>
<p>本讲默认读者已经了解R语言的基本语法，能够在自己的电脑中成功编写和运行R脚本。</p>
<h1>一、线性回归的建立与解读</h1>
<h2 id="1-1-示例数据集介绍">1.1 示例数据集介绍</h2>
<p>本讲所使用的数据集是加拉帕戈斯群岛的物种数据，需要首先下载<code>faraway</code>包，并导入数据集<code>gala</code>：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> install.packages<span class="punctuation">(</span><span class="string">&quot;faraway&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> data<span class="punctuation">(</span>gala<span class="punctuation">,</span> package <span class="operator">=</span> <span class="string">&quot;faraway&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> head<span class="punctuation">(</span>gala<span class="punctuation">[</span><span class="punctuation">,</span><span class="operator">-</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">             Species  Area Elevation Nearest Scruz Adjacent</span><br><span class="line">Baltra            <span class="number">58</span> <span class="number">25.09</span>       <span class="number">346</span>     <span class="number">0.6</span>   <span class="number">0.6</span>     <span class="number">1.84</span></span><br><span class="line">Bartolome         <span class="number">31</span>  <span class="number">1.24</span>       <span class="number">109</span>     <span class="number">0.6</span>  <span class="number">26.3</span>   <span class="number">572.33</span></span><br><span class="line">Caldwell           <span class="number">3</span>  <span class="number">0.21</span>       <span class="number">114</span>     <span class="number">2.8</span>  <span class="number">58.7</span>     <span class="number">0.78</span></span><br><span class="line">Champion          <span class="number">25</span>  <span class="number">0.10</span>        <span class="number">46</span>     <span class="number">1.9</span>  <span class="number">47.4</span>     <span class="number">0.18</span></span><br><span class="line">Coamano            <span class="number">2</span>  <span class="number">0.05</span>        <span class="number">77</span>     <span class="number">1.9</span>   <span class="number">1.9</span>   <span class="number">903.82</span></span><br><span class="line">Daphne.Major      <span class="number">18</span>  <span class="number">0.34</span>       <span class="number">119</span>     <span class="number">8.0</span>   <span class="number">8.0</span>     <span class="number">1.84</span></span><br></pre></td></tr></table></figure>
<p>数据解读：数据集每行代表一座岛屿（共30座），列分别代表物种数量(Species)、岛屿面积(Area)、最高高地(Elevation)、最近岛屿距离(Nearest)、到Santa Cruz岛的距离(Scruz)、邻接岛面积(Adjacent)。所有列均为连续变量。</p>
<div class="warning">
<p><code>gala[,-2]</code>表示我们不使用原始数据的第2列。</p>
</div>
<p>针对这个数据集，我们的研究目标是：岛屿的物种数量到底与什么因素有关？</p>
<p>考虑到数据集中响应变量和自变量都是连续变量，故考虑以Species为响应变量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>、其余列为自变量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>，使用线性回归来构建模型。</p>
<h2 id="1-2-建立线性回归模型">1.2 建立线性回归模型</h2>
<p>在R语言中建立线性回归模型很容易，你可以直接使用R内置的<code>lm()</code>函数。<code>lm()</code>函数的基本语法为：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">myfit <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>formula<span class="punctuation">,</span> data<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>其中<code>data</code>表示输入数据，一般是数据框形式；<code>formula</code>表示拟合的公式，也就是规定自变量和响应变量，形如：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">Y <span class="operator">~</span> X1 <span class="operator">+</span> X2 <span class="operator">+</span> ... <span class="operator">+</span> Xk</span><br></pre></td></tr></table></figure>
<p><code>formula</code>中可使用以下符号：</p>
<table>
<thead>
<tr>
<th style="text-align:center">符号</th>
<th style="text-align:center">用途</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>~</code></td>
<td style="text-align:center">分开响应变量与自变量，左边为响应变量，右边是自变量</td>
</tr>
<tr>
<td style="text-align:center"><code>+</code></td>
<td style="text-align:center">分隔自变量</td>
</tr>
<tr>
<td style="text-align:center"><code>:</code></td>
<td style="text-align:center">定义自变量组成的交叉项</td>
</tr>
<tr>
<td style="text-align:center"><code>*</code></td>
<td style="text-align:center">定义自变量的所有单独项和交叉项</td>
</tr>
<tr>
<td style="text-align:center"><code>^</code></td>
<td style="text-align:center">定义幂次</td>
</tr>
<tr>
<td style="text-align:center"><code>.</code></td>
<td style="text-align:center">简写，等价于数据框中所有非响应变量</td>
</tr>
<tr>
<td style="text-align:center"><code>-</code></td>
<td style="text-align:center">删除某一个自变量</td>
</tr>
<tr>
<td style="text-align:center"><code>-1</code></td>
<td style="text-align:center">删除截距项</td>
</tr>
<tr>
<td style="text-align:center"><code>I()</code></td>
<td style="text-align:center">将某一自变量组合作为一个整体来考察</td>
</tr>
<tr>
<td style="text-align:center"><code>func</code></td>
<td style="text-align:center">可以对变量使用数学函数，如<code>log(y)~x</code></td>
</tr>
</tbody>
</table>
<p>我们按照构建模型的语法，建立线性回归，并保存在变量<code>lmod</code>中。<code>summary()</code>可以帮我们优化输出这个模型的各项结果：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> lmod <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>Species <span class="operator">~</span> Area <span class="operator">+</span> Elevation <span class="operator">+</span> Nearest <span class="operator">+</span> Scruz <span class="operator">+</span> Adjacent<span class="punctuation">,</span> data <span class="operator">=</span> gala<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> summary<span class="punctuation">(</span>lmod<span class="punctuation">)</span></span><br><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> Species <span class="operator">~</span> Area <span class="operator">+</span> Elevation <span class="operator">+</span> Nearest <span class="operator">+</span> Scruz <span class="operator">+</span> Adjacent<span class="punctuation">,</span> </span><br><span class="line">    data <span class="operator">=</span> gala<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">Residuals<span class="operator">:</span></span><br><span class="line">     Min       <span class="number">1</span>Q   Median       <span class="number">3</span>Q      Max </span><br><span class="line"><span class="operator">-</span><span class="number">111.679</span>  <span class="operator">-</span><span class="number">34.898</span>   <span class="operator">-</span><span class="number">7.862</span>   <span class="number">33.460</span>  <span class="number">182.584</span> </span><br><span class="line"></span><br><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">7.068221</span>  <span class="number">19.154198</span>   <span class="number">0.369</span> <span class="number">0.715351</span>    </span><br><span class="line">Area        <span class="operator">-</span><span class="number">0.023938</span>   <span class="number">0.022422</span>  <span class="operator">-</span><span class="number">1.068</span> <span class="number">0.296318</span>    </span><br><span class="line">Elevation    <span class="number">0.319465</span>   <span class="number">0.053663</span>   <span class="number">5.953</span> <span class="number">3.82e-06</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Nearest      <span class="number">0.009144</span>   <span class="number">1.054136</span>   <span class="number">0.009</span> <span class="number">0.993151</span>    </span><br><span class="line">Scruz       <span class="operator">-</span><span class="number">0.240524</span>   <span class="number">0.215402</span>  <span class="operator">-</span><span class="number">1.117</span> <span class="number">0.275208</span>    </span><br><span class="line">Adjacent    <span class="operator">-</span><span class="number">0.074805</span>   <span class="number">0.017700</span>  <span class="operator">-</span><span class="number">4.226</span> <span class="number">0.000297</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Residual standard error<span class="operator">:</span> <span class="number">60.98</span> on <span class="number">24</span> degrees of freedom</span><br><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.7658</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.7171</span> </span><br><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span>  <span class="number">15.7</span> on <span class="number">5</span> and <span class="number">24</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">6.838e-07</span></span><br></pre></td></tr></table></figure>
<p>模型的输出结果非常多，不要着急，我们会逐一讲解。</p>
<h2 id="1-3-模型拟合参数解读">1.3 模型拟合参数解读</h2>
<p>我们先看回归系数部分，也就是<code>Coefficients</code>部分：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">Coefficients<span class="operator">:</span></span><br><span class="line">             Estimate Std. Error t value Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="operator">|</span>t<span class="operator">|</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">7.068221</span>  <span class="number">19.154198</span>   <span class="number">0.369</span> <span class="number">0.715351</span>    </span><br><span class="line">Area        <span class="operator">-</span><span class="number">0.023938</span>   <span class="number">0.022422</span>  <span class="operator">-</span><span class="number">1.068</span> <span class="number">0.296318</span>    </span><br><span class="line">Elevation    <span class="number">0.319465</span>   <span class="number">0.053663</span>   <span class="number">5.953</span> <span class="number">3.82e-06</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">Nearest      <span class="number">0.009144</span>   <span class="number">1.054136</span>   <span class="number">0.009</span> <span class="number">0.993151</span>    </span><br><span class="line">Scruz       <span class="operator">-</span><span class="number">0.240524</span>   <span class="number">0.215402</span>  <span class="operator">-</span><span class="number">1.117</span> <span class="number">0.275208</span>    </span><br><span class="line">Adjacent    <span class="operator">-</span><span class="number">0.074805</span>   <span class="number">0.017700</span>  <span class="operator">-</span><span class="number">4.226</span> <span class="number">0.000297</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>coefficients部分是一个类似表格的格式，每一行代表每一个自变量的拟合信息，其中第一行的<code>Intercept</code>就是截距项。<code>lm()</code>默认模型带有截距项，如果你不想要截距项，就可以把公式改成<code>Y ~ X1 + X2 + ... + Xk - 1</code>。</p>
<p><code>Estimate</code>列代表每一个自变量对应的回归系数的估计值，也就是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>β</mi><mo>^</mo></mover><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\hat\beta_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1523em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，截距项代表截距的大小。为了展示回归系数的估计过程，我们尝试自己来实现一下。首先我们调用<code>model.matrix()</code>函数来生成设计矩阵，并保存响应变量：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> model.matrix<span class="punctuation">(</span> <span class="operator">~</span> Area <span class="operator">+</span> Elevation <span class="operator">+</span> Nearest <span class="operator">+</span> Scruz <span class="operator">+</span> Adjacent<span class="punctuation">,</span> data <span class="operator">=</span> gala<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> y <span class="operator">&lt;-</span> gala<span class="operator">$</span>Species</span><br></pre></td></tr></table></figure>
<p>接下来我们根据正规方程来求解回归系数。为了避免回归系数的解可能不唯一，我们调用成熟的<code>solve()</code>函数来求解：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> solve<span class="punctuation">(</span>crossprod<span class="punctuation">(</span>x<span class="punctuation">,</span>x<span class="punctuation">)</span><span class="punctuation">,</span>crossprod<span class="punctuation">(</span>x<span class="punctuation">,</span>y<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">                    <span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>  <span class="number">7.068220709</span></span><br><span class="line">Area        <span class="operator">-</span><span class="number">0.023938338</span></span><br><span class="line">Elevation    <span class="number">0.319464761</span></span><br><span class="line">Nearest      <span class="number">0.009143961</span></span><br><span class="line">Scruz       <span class="operator">-</span><span class="number">0.240524230</span></span><br><span class="line">Adjacent    <span class="operator">-</span><span class="number">0.074804832</span></span><br></pre></td></tr></table></figure>
<p><code>crossprod()</code>是叉乘函数，在这里表示矩阵乘法；<code>solve()</code>是一个求解器，<code>solve(A,b)</code>表示求解<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>x</mi><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">Ax=b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>的解，这里正好对应正规方程的解。可以看到，求解的结果和<code>lm()</code>拟合的结果一致。</p>
<p><code>Std.Error</code>列代表回归系数估计值的标准差，也就是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>e</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>β</mi><mo>^</mo></mover><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">se(\hat\beta_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2079em;vertical-align:-0.25em;"></span><span class="mord mathnormal">se</span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>。根据理论知识，如果假定残差服从正态分布，那么就有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>β</mi><mo>^</mo></mover><mo>∼</mo><mi>N</mi><mo stretchy="false">(</mo><mi>β</mi><mo separator="true">,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><msup><mo stretchy="false">)</mo><mo>−</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat\beta\sim N(\beta,\sigma^2(X^TX)^-)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1523em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7713em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>。因此，如果得到了残差方差的估计值，且设计矩阵已知，就可以计算回归系数的标准差了：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>s</mi><mi>e</mi><mo stretchy="false">(</mo><mover accent="true"><mi>β</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo>=</mo><mover accent="true"><mi>σ</mi><mo>^</mo></mover><msqrt><mrow><mo stretchy="false">(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><msubsup><mo stretchy="false">)</mo><mrow><mi>i</mi><mi>i</mi></mrow><mo>−</mo></msubsup></mrow></msqrt></mrow><annotation encoding="application/x-tex">se(\hat\beta)=\hat\sigma\sqrt{(X^TX)^-_{ii}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2079em;vertical-align:-0.25em;"></span><span class="mord mathnormal">se</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.84em;vertical-align:-0.5388em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3012em;"><span class="svg-align" style="top:-3.8em;"><span class="pstrut" style="height:3.8em;"></span><span class="mord" style="padding-left:1em;"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7673em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8115em;"><span style="top:-2.4231em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ii</span></span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.2612em;"><span class="pstrut" style="height:3.8em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.88em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.88em" viewBox="0 0 400000 1944" preserveAspectRatio="xMinYMin slice"><path d="M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5388em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>根据公式来看，我们要解决两个问题，一个是方差/标准差参数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>σ</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span>，另一个是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><msubsup><mo stretchy="false">)</mo><mrow><mi>i</mi><mi>i</mi></mrow><mo>−</mo></msubsup></mrow><annotation encoding="application/x-tex">(X^TX)^-_{ii}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1182em;vertical-align:-0.2769em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8115em;"><span style="top:-2.4231em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ii</span></span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span></span></span></span>。</p>
<p>方差参数其实已经在程序输出结果中体现，请在输出结果中查看这一行：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">Residual standard error<span class="operator">:</span> <span class="number">60.98</span> on <span class="number">24</span> degrees of freedom</span><br></pre></td></tr></table></figure>
<p>这一行是残差标准差，也就是残差方差的平方根。如果你想直接获得这个数值，也可以直接访问：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> lmodsum <span class="operator">&lt;-</span> summary<span class="punctuation">(</span>lmod<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> lmodsum<span class="operator">$</span>sigma</span><br><span class="line"><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="number">60.97519</span></span><br></pre></td></tr></table></figure>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><msubsup><mo stretchy="false">)</mo><mrow><mi>i</mi><mi>i</mi></mrow><mo>−</mo></msubsup></mrow><annotation encoding="application/x-tex">(X^TX)^-_{ii}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1182em;vertical-align:-0.2769em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8115em;"><span style="top:-2.4231em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ii</span></span></span></span><span style="top:-3.1031em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span></span></span></span>可以通过<code>cov.unscaled</code>的值获得：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> xtxi <span class="operator">&lt;-</span> lmodsum<span class="operator">$</span>cov.unscaled</span><br></pre></td></tr></table></figure>
<p>最后我们取对角元开平方根，再和前面的标准差相乘，就得到了<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>e</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>β</mi><mo>^</mo></mover><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">se(\hat\beta_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2079em;vertical-align:-0.25em;"></span><span class="mord mathnormal">se</span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，可以看到和<code>Std.Error</code>列的值一模一样：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="built_in">sqrt</span><span class="punctuation">(</span>diag<span class="punctuation">(</span>xtxi<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">*</span>lmodsum<span class="operator">$</span>sigma</span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span>        Area   Elevation     Nearest       Scruz    Adjacent </span><br><span class="line"><span class="number">19.15419782</span>  <span class="number">0.02242235</span>  <span class="number">0.05366280</span>  <span class="number">1.05413595</span>  <span class="number">0.21540225</span>  <span class="number">0.01770019</span></span><br></pre></td></tr></table></figure>
<div class="tips">
<p>当然，残差方差估计值也可以自己计算。我们已经知道残差方差的估计值为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover accent="true"><mi>σ</mi><mo>^</mo></mover><mn>2</mn></msup><mo>=</mo><msup><mover accent="true"><mi>e</mi><mo>^</mo></mover><mi>T</mi></msup><mover accent="true"><mi>e</mi><mo>^</mo></mover><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat\sigma^2=\hat e^T\hat e/(n-r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">e</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">e</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mord">/</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span>，这里<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>e</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">e</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span>表示残差，那么分子就是残差平方和，可以通过<code>deviance()</code>函数获得；而<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">n-r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>可以通过<code>df.residual()</code>函数来获得，再开平方根就能获得结果了：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> <span class="built_in">sqrt</span><span class="punctuation">(</span>deviance<span class="punctuation">(</span>lmod<span class="punctuation">)</span><span class="operator">/</span>df.residual<span class="punctuation">(</span>lmod<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
</div>
<p>剩下还有两列，分别是 <code>t value</code>和<code>Pr(&gt;|t|)</code>，以及<code>Signif. codes</code>部分。这些内容和回归系数的假设检验有关，我们在下面第2节展开说明。</p>
<h2 id="1-4-其他输出解读">1.4 其他输出解读</h2>
<p>除了回归系数，我们再看看别的输出。</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">Call<span class="operator">:</span></span><br><span class="line">lm<span class="punctuation">(</span>formula <span class="operator">=</span> Species <span class="operator">~</span> Area <span class="operator">+</span> Elevation <span class="operator">+</span> Nearest <span class="operator">+</span> Scruz <span class="operator">+</span> Adjacent<span class="punctuation">,</span> </span><br><span class="line">    data <span class="operator">=</span> gala<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><code>Call</code>输出拟合的模型结构，你可以检查你的输入和程序实际使用的模型是否一致。</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">Residuals<span class="operator">:</span></span><br><span class="line">     Min       <span class="number">1</span>Q   Median       <span class="number">3</span>Q      Max </span><br><span class="line"><span class="operator">-</span><span class="number">111.679</span>  <span class="operator">-</span><span class="number">34.898</span>   <span class="operator">-</span><span class="number">7.862</span>   <span class="number">33.460</span>  <span class="number">182.584</span> </span><br></pre></td></tr></table></figure>
<p><code>Residuals</code>输出模型的残差统计，模型会对每一个样本计算其残差值，然后将所有残差值进行汇总统计。上述各列从左至右依次为：最小值、第一分位数、中位数、第三分位数，最大值。</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">Multiple R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.7658</span><span class="punctuation">,</span>	Adjusted R<span class="operator">-</span>squared<span class="operator">:</span>  <span class="number">0.7171</span> </span><br></pre></td></tr></table></figure>
<p>这一行涉及的内容我们还没有在理论知识中介绍到，但是简单来说就是<strong>反映数据拟合好坏</strong>的一个指标，称为<mark>决定系数</mark>。输出中<code>Multiple R-squared</code>就代表了决定系数，这个值是在0到1范围内波动的连续值，如果该值越靠近1，说明数据的分布越接近模型的结构，拟合效果越好；反之如果该值越靠近0，说明这个数据不太能用这个模型来解释，拟合效果差。</p>
<p>有关决定系数方面的理论知识将在下一讲进行介绍。</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span>  <span class="number">15.7</span> on <span class="number">5</span> and <span class="number">24</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">6.838e-07</span></span><br></pre></td></tr></table></figure>
<p>这一行是关于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>统计量以及<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>值，在本讲第2节就会介绍。</p>
<h1>二、线性回归的假设检验与预测</h1>
<h2 id="2-1-模型显著性检验">2.1 模型显著性检验</h2>
<p>模型显著性检验，即检验模型结构是否成立，也即检验我们选择的自变量中是否存在重要变量。原假设为：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><mo>⋯</mo><mo>=</mo><msub><mi>β</mi><mi>p</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_0:\beta_1=\cdots=\beta_p=0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span></p>
<p>如果模型显著，则说明至少有一个回归系数/自变量是重要的。</p>
<p>那接下来要做的就是构建原假设满足的模型。如果原假设成立，那么模型只剩下截距项/常数项，这样的模型我们又称为<mark>零模型</mark>(Null Model)。在R语言中这样构建：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> nullmod <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>Species <span class="operator">~</span> <span class="number">1</span><span class="punctuation">,</span> gala<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>如果要对比零模型和我们的拟合模型，需要进行<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>检验。这里我们使用<code>anova()</code>函数，该函数可以接受两个模型，并通过构建方差分析表来进行<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>检验：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>nullmod<span class="punctuation">,</span> lmod<span class="punctuation">)</span></span><br><span class="line">Analysis of Variance Table</span><br><span class="line"></span><br><span class="line">Model <span class="number">1</span><span class="operator">:</span> Species <span class="operator">~</span> <span class="number">1</span></span><br><span class="line">Model <span class="number">2</span><span class="operator">:</span> Species <span class="operator">~</span> Area <span class="operator">+</span> Elevation <span class="operator">+</span> Nearest <span class="operator">+</span> Scruz <span class="operator">+</span> Adjacent</span><br><span class="line">  Res.Df    RSS Df Sum of Sq      <span class="built_in">F</span>    Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span>    </span><br><span class="line"><span class="number">1</span>     <span class="number">29</span> <span class="number">381081</span>                                  </span><br><span class="line"><span class="number">2</span>     <span class="number">24</span>  <span class="number">89231</span>  <span class="number">5</span>    <span class="number">291850</span> <span class="number">15.699</span> <span class="number">6.838e-07</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="operator">-</span><span class="operator">-</span><span class="operator">-</span></span><br><span class="line">Signif. codes<span class="operator">:</span>  <span class="number">0</span> ‘<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.001</span> ‘<span class="operator">*</span><span class="operator">*</span>’ <span class="number">0.01</span> ‘<span class="operator">*</span>’ <span class="number">0.05</span> ‘.’ <span class="number">0.1</span> ‘ ’ <span class="number">1</span></span><br></pre></td></tr></table></figure>
<div class="warning">
<p>你或许不知道我说的方差分析表是什么，这不是你的错。方差分析表源自于方差分析，是我们后面要学习的特殊回归模型，不过你现在不必知道是什么，你只需知道<code>anova()</code>函数可以对两个模型进行<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>检验。</p>
</div>
<p>输出结果中，<code>Model 1</code>和<code>Model 2</code>分别代表零模型和拟合模型，对于下方的数据表我们只需要关心<code>F</code>列和<code>Pr(&gt;F)</code>列。这里的<code>F</code>列就是指我们在理论知识中构造的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>统计量的值，而<code>Pr(&gt;F)</code>列就是p值。可以看到，这里的输出结果和之前的summary结果是一样的：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="built_in">F</span><span class="operator">-</span>statistic<span class="operator">:</span>  <span class="number">15.7</span> on <span class="number">5</span> and <span class="number">24</span> DF<span class="punctuation">,</span>  p<span class="operator">-</span>value<span class="operator">:</span> <span class="number">6.838e-07</span></span><br></pre></td></tr></table></figure>
<p>p值后面还有几个“*”，这代表p值达到的显著性水平，不同的“*”个数对应下面的<code>Signif. codes</code>所指的显著性水平。</p>
<h2 id="2-2-回归系数显著性检验">2.2 回归系数显著性检验</h2>
<p>对模型整体进行检验之后，我们还想进一步知道每一个回归系数是否显著不为0，也就是检验：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>β</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_0:\beta_i=0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span></p>
<p>根据理论知识，我们可以对每一个回归系数构造统计量：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo>=</mo><mfrac><msub><mover accent="true"><mi>β</mi><mo>^</mo></mover><mi>i</mi></msub><mrow><mi>s</mi><mi>e</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>β</mi><mo>^</mo></mover><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mfrac><mo>∼</mo><msub><mi>t</mi><mrow><mi>n</mi><mo>−</mo><mi>p</mi></mrow></msub></mrow><annotation encoding="application/x-tex">t_i=\frac{\hat\beta_i}{se(\hat\beta_i)}\sim t_{n-p}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.7328em;vertical-align:-1.0979em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6349em;"><span style="top:-2.1521em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">se</span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0979em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9012em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2583em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>通过检验<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>统计量就可以知道回归系数的显著性了。那么1.3小节中的<code>t value</code>列其实就是这个值，你可以试试将<code>Estimate</code>列和<code>Std. Error</code>列的值对应相除，就可以得到<code>t value</code>列的值。同时，<code>Pr(&gt;|t|)</code>列就代表对应的p值，其后面的“*”代表p值达到的显著性水平，不同的“*”个数对应下面的<code>Signif. codes</code>所指的显著性水平。</p>
<p>当然，我们还可以仿效2.1小节的方法，自己构建一个更小的模型，然后通过<code>anova()</code>函数进行检验。比如，我想检验Area项的系数是否显著，就可以这样做：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> lmods <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>Species <span class="operator">~</span> Elevation <span class="operator">+</span> Nearest <span class="operator">+</span> Scruz <span class="operator">+</span> Adjacent<span class="punctuation">,</span> gala<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> anova<span class="punctuation">(</span>lmods<span class="punctuation">,</span> lmod<span class="punctuation">)</span></span><br><span class="line">Analysis of Variance Table</span><br><span class="line"></span><br><span class="line">Model <span class="number">1</span><span class="operator">:</span> Species <span class="operator">~</span> Elevation <span class="operator">+</span> Nearest <span class="operator">+</span> Scruz <span class="operator">+</span> Adjacent</span><br><span class="line">Model <span class="number">2</span><span class="operator">:</span> Species <span class="operator">~</span> Area <span class="operator">+</span> Elevation <span class="operator">+</span> Nearest <span class="operator">+</span> Scruz <span class="operator">+</span> Adjacent</span><br><span class="line">  Res.Df   RSS Df Sum of Sq      <span class="built_in">F</span> Pr<span class="punctuation">(</span><span class="operator">&gt;</span><span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line"><span class="number">1</span>     <span class="number">25</span> <span class="number">93469</span>                           </span><br><span class="line"><span class="number">2</span>     <span class="number">24</span> <span class="number">89231</span>  <span class="number">1</span>    <span class="number">4237.7</span> <span class="number">1.1398</span> <span class="number">0.2963</span></span><br></pre></td></tr></table></figure>
<p>可以看到，<code>Model 1</code>相对于<code>Model 2</code>少了一项<code>Area</code>，两个模型检验发现<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>值不显著，就说明Area项对种群数量的贡献不显著。</p>
<p>除了对每个回归系数进行显著性检验，我们还可以仿照上面的方法进行更多花式检验，例如我想检验<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mrow><mi>A</mi><mi>r</mi><mi>e</mi><mi>a</mi></mrow></msub><mo>=</mo><msub><mi>β</mi><mrow><mi>E</mi><mi>l</mi><mi>e</mi><mi>v</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\beta_{Area}=\beta_{Elevation}=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight">re</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">El</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>，我们就可以这样构建：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> lmods <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>Species <span class="operator">~</span> Nearest <span class="operator">+</span> Scruz <span class="operator">+</span> Adjacent<span class="punctuation">,</span> gala<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>然后跟原来的拟合模型进行对比，得出<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>值。</p>
<p>又或者我只想检验<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mrow><mi>A</mi><mi>r</mi><mi>e</mi><mi>a</mi></mrow></msub><mo>=</mo><msub><mi>β</mi><mrow><mi>E</mi><mi>l</mi><mi>e</mi><mi>v</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\beta_{Area}=\beta_{Elevation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight">re</span><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">El</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，那么可以这样构建：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> lmods <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>Species <span class="operator">~</span> I<span class="punctuation">(</span>Elevation <span class="operator">+</span> Area<span class="punctuation">)</span> <span class="operator">+</span> Nearest <span class="operator">+</span> Scruz <span class="operator">+</span> Adjacent<span class="punctuation">,</span> gala<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>通过<code>I()</code>将两个自变量看成一个整体来检验，如果差异显著，说明这两个变量的回归系数不同；如果没有显著差异，说明这两个回归系数的效应相同。</p>
<p>你还可以自己开发各种检验方法来验证你的结论，增强模型说服力。</p>
<h2 id="2-3-回归系数的置信区间">2.3 回归系数的置信区间</h2>
<p>在对回归系数做完检验之后，我们还需要估计置信区间。如果你只想对每一个回归系数单独计算置信区间，那我们可以根据<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>检验来构建置信区间，即：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mi>β</mi><mo>^</mo></mover><mi>i</mi></msub><mo>±</mo><msubsup><mi>t</mi><mrow><mi>n</mi><mo>−</mo><mi>p</mi></mrow><mrow><mi>α</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow></msubsup><mi>s</mi><mi>e</mi><mo stretchy="false">(</mo><msub><mover accent="true"><mi>β</mi><mo>^</mo></mover><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat\beta_i\pm t_{n-p}^{\alpha/2}se(\hat\beta_i)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1523em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">±</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.4044em;vertical-align:-0.3596em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4765em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span><span class="mord mtight">/2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3596em;"><span></span></span></span></span></span></span><span class="mord mathnormal">se</span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9579em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>对于模型：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> lmod <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>Species <span class="operator">~</span> Area <span class="operator">+</span> Elevation <span class="operator">+</span> Nearest <span class="operator">+</span> Scruz <span class="operator">+</span> Adjacent<span class="punctuation">,</span> data <span class="operator">=</span> gala<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>我们可以利用内置的<code>confint()</code>函数对每一个自变量计算置信区间（包括截距）：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> confint<span class="punctuation">(</span>lmod<span class="punctuation">)</span></span><br><span class="line">                  <span class="number">2.5</span> <span class="operator">%      97.5 %</span></span><br><span class="line"><span class="punctuation">(</span>Intercept<span class="punctuation">)</span> <span class="operator">-</span><span class="number">32.4641006</span> <span class="number">46.60054205</span></span><br><span class="line">Area         <span class="operator">-</span><span class="number">0.0702158</span>  <span class="number">0.02233912</span></span><br><span class="line">Elevation     <span class="number">0.2087102</span>  <span class="number">0.43021935</span></span><br><span class="line">Nearest      <span class="operator">-</span><span class="number">2.1664857</span>  <span class="number">2.18477363</span></span><br><span class="line">Scruz        <span class="operator">-</span><span class="number">0.6850926</span>  <span class="number">0.20404416</span></span><br><span class="line">Adjacent     <span class="operator">-</span><span class="number">0.1113362</span> <span class="operator">-</span><span class="number">0.03827344</span></span><br></pre></td></tr></table></figure>
<p>如果要给出同时置信区间，我们不能使用<code>confint()</code>函数了。但是，似乎没有现成的包可以使用，只能根据我们学习的定义来计算。这里我们不展开，我们先通过绘制两个变量单独的置信区间以及两个变量的同时置信区间来体会二者的区别。我们以Area（第2个参数）和Adjacent（第6个参数）为例，画出二者单独的置信区间（虚线）以及同时置信椭球（实线）：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># install.packages(&quot;ellipse&quot;)</span></span><br><span class="line"><span class="operator">&gt;</span> require<span class="punctuation">(</span>ellipse<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> plot<span class="punctuation">(</span>ellipse<span class="punctuation">(</span>lmod<span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span>type<span class="operator">=</span><span class="string">&quot;l&quot;</span><span class="punctuation">,</span>ylim<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">0.13</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> points<span class="punctuation">(</span>coef<span class="punctuation">(</span>lmod<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span> coef<span class="punctuation">(</span>lmod<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">6</span><span class="punctuation">]</span><span class="punctuation">,</span> pch<span class="operator">=</span><span class="number">19</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> abline<span class="punctuation">(</span>v<span class="operator">=</span>confint<span class="punctuation">(</span>lmod<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">,</span>lty<span class="operator">=</span><span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> abline<span class="punctuation">(</span>h<span class="operator">=</span>confint<span class="punctuation">(</span>lmod<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">6</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">,</span>lty<span class="operator">=</span><span class="number">2</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src="4.2.3-1.png" alt="两个变量的置信椭球"></p>
<p>可以看到，尽管两个变量单独的置信区间可以形成一个方形区域，但是同时置信区间并不是这样，二者相互制约，控制着总体的错误率，从直观上我们看到了单独的置信区间和同时置信区间是有所区别的。</p>
<h2 id="2-4-线性回归的预测">2.4 线性回归的预测</h2>
<p>最后我们来看如何利用拟合的模型完成预测。这里我们临时使用一个新的数据集——<code>fat</code>，该数据收录了252名男性身体的13个参数，包括年龄、身高、体重等，并依据Brozek方程来估计他们的体脂率。我们仍然使用线性回归模型来拟合：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> data<span class="punctuation">(</span>fat<span class="punctuation">,</span> package <span class="operator">=</span> <span class="string">&quot;faraway&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> lmod <span class="operator">&lt;-</span> lm<span class="punctuation">(</span>brozek <span class="operator">~</span> age <span class="operator">+</span> weight <span class="operator">+</span> height <span class="operator">+</span> neck <span class="operator">+</span> chest <span class="operator">+</span> abdom <span class="operator">+</span> hip <span class="operator">+</span> thigh <span class="operator">+</span> knee <span class="operator">+</span> ankle <span class="operator">+</span> biceps <span class="operator">+</span> forearm <span class="operator">+</span> wrist<span class="punctuation">,</span> data<span class="operator">=</span>fat<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>具体的拟合效果我们不再分析，现在我们只关注如何使用该模型进行预测。我们分别取每个自变量的中位数作为一个新的样本点，预测其<code>brozek</code>值：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> x <span class="operator">&lt;-</span> model.matrix<span class="punctuation">(</span>lmod<span class="punctuation">)</span></span><br><span class="line"><span class="operator">&gt;</span> x0 <span class="operator">&lt;-</span> apply<span class="punctuation">(</span>x<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span>median<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>要实现预测，我们直接将这个输入乘以拟合的系数即可，其中<code>coef()</code>函数可以返回模型的参数向量：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> y0 <span class="operator">&lt;-</span> <span class="built_in">sum</span><span class="punctuation">(</span>x0<span class="operator">*</span>coef<span class="punctuation">(</span>lmod<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 17.49322</span></span><br></pre></td></tr></table></figure>
<p>当然，这种方法比较简陋，一个更成熟的方法是使用<code>predict()</code>函数：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> predict<span class="punctuation">(</span>lmod<span class="punctuation">,</span> new<span class="operator">=</span>data.frame<span class="punctuation">(</span>t<span class="punctuation">(</span>x0<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">       <span class="number">1</span> </span><br><span class="line"><span class="number">17.49322</span></span><br></pre></td></tr></table></figure>
<p>除了点预测，我们还对区间预测感兴趣。<code>predict()</code>函数可以输出预测区间：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> predict<span class="punctuation">(</span>lmod<span class="punctuation">,</span> new<span class="operator">=</span>data.frame<span class="punctuation">(</span>t<span class="punctuation">(</span>x0<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> interval <span class="operator">=</span> <span class="string">&quot;prediction&quot;</span><span class="punctuation">)</span></span><br><span class="line">       fit     lwr      upr</span><br><span class="line"><span class="number">1</span> <span class="number">17.49322</span> <span class="number">9.61783</span> <span class="number">25.36861</span></span><br></pre></td></tr></table></figure>
<p><code>lwr</code>是区间预测下界，<code>upr</code>是区间上界。</p>
<p>除了预测区间，我们还可以给出新的样本点的置信区间：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">&gt;</span> predict<span class="punctuation">(</span>lmod<span class="punctuation">,</span> new<span class="operator">=</span>data.frame<span class="punctuation">(</span>t<span class="punctuation">(</span>x0<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> interval <span class="operator">=</span> <span class="string">&quot;confidence&quot;</span><span class="punctuation">)</span></span><br><span class="line">       fit      lwr      upr</span><br><span class="line"><span class="number">1</span> <span class="number">17.49322</span> <span class="number">16.94426</span> <span class="number">18.04219</span></span><br></pre></td></tr></table></figure>
<div class="warning">
<p><strong>预测区间和置信区间有什么区别？</strong></p>
<p>预测区间是指<strong>在这个x值下，某个新样本的y的可能值</strong>，它的区间更宽，考虑了估计均值的不确定性和随机误差；</p>
<p>置信区间是指<strong>在这个x值下，y的真实值的平均值</strong>，它的区间更窄，只考虑估计均值的不确定性。</p>
<p>总结来说，预测区间考虑的是在某个x值下观测值取值的区间，置信区间考虑的是在某个x值下观测值取值的均值的区间。</p>
</div>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://cien-su.github.io">Redamancy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://cien-su.github.io/2025/10/28/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%E7%AC%AC4%E8%AE%B2%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8ER%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/">https://cien-su.github.io/2025/10/28/回归分析/回归分析第4讲——基于R语言实现线性回归/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://cien-su.github.io" target="_blank">生信人的知识库</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C/">假设检验</a><a class="post-meta__tags" href="/tags/R/">R</a><a class="post-meta__tags" href="/tags/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/">线性回归</a><a class="post-meta__tags" href="/tags/%E5%8F%82%E6%95%B0%E4%BC%B0%E8%AE%A1/">参数估计</a><a class="post-meta__tags" href="/tags/%E7%BD%AE%E4%BF%A1%E5%8C%BA%E9%97%B4/">置信区间</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/10/29/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%E7%AC%AC5%E8%AE%B2%E2%80%94%E2%80%94%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E7%9A%84%E8%AF%8A%E6%96%AD%E4%B8%8E%E4%BC%98%E5%8C%96/" title="回归分析第5讲——线性回归的诊断与优化"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">回归分析第5讲——线性回归的诊断与优化</div></div><div class="info-2"><div class="info-item-1">前面我们介绍了线性回归如何建立，如何做统计推断，以及如何完成预测。这一节我们来学习如何判断拟合的线性回归模型是否足够好，如果不好应当如何优化。为了一般性，本讲所使用的模型都是带截距项的、进行过中心化处理的线性回归模型，即： Y=αEn+X~cβI+eY=\alpha E_n+\widetilde X_c\beta_I+e Y=αEn​+Xc​βI​+e 另外，为了更好的进行说明，我们补充一点记号。我们已经知道： Y^=Xβ^=X(XTX)−1XTY\hat Y=X\hat\beta=X(X^TX)^{-1}X^TY Y^=Xβ^​=X(XTX)−1XTY 我们记H≡X(XTX)−1XTH\equiv X(X^TX)^{-1}X^TH≡X(XTX)−1XT，这个矩阵有个专有名词，称为帽子矩阵(Hat Matrix)。 帽子矩阵是一个投影矩阵，所以它对称幂等，且有： rank(H)=tr(H)=p,HX=X,HEn=Enrank(H)=tr(H)=p,HX=X,HE_n=E_n rank(H)=tr(H)=p,HX=X,HEn​=En​ 为了后续叙述方便，我们记帽子矩阵的对角元是hi...</div></div></div></a><a class="pagination-related" href="/2025/10/27/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%E7%AC%AC3%E8%AE%B2%E2%80%94%E2%80%94%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E7%9A%84%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C/" title="回归分析第3讲——线性回归的假设检验"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">回归分析第3讲——线性回归的假设检验</div></div><div class="info-2"><div class="info-item-1">一、模型检验 一旦我们完成了线性回归的参数拟合之后，就要对模型进行检验。那么为什么要进行检验？目的无非有两个：  检测模型的显著性，即模型结构是否存在，在数学上也就是验证回归系数β1,⋯ ,βp\beta_1,\cdots,\beta_pβ1​,⋯,βp​之中至少有一个系数不为0，这样模型才会有线性成分，模型结构才会成立； 检验回归系数的显著性，即到底哪些回归系数可以认为不是0的，即真正对观测值yyy有贡献的是哪些项，这样我们才能精准地找到关键特征。  那么接下来我们就从一般线性回归开始，介绍模型检验的原理和方法。 1.1 一般线性回归的检验 为了不失一般性，并且将模型显著性和系数显著性检验统一起来，我们设模型为： Y=Xn×pβ+e,e∼N(0,σ2In)Y=X_{n\times p}\beta+e,e\sim N(0,\sigma^2I_n) Y=Xn×p​β+e,e∼N(0,σ2In​) 假定rank(X)=rrank(X)=rrank(X)=r，给定已知矩阵Hm×pH_{m\times p}Hm×p​，rank(H)=mrank(H)=mrank(H)=m，那么我们的假设...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/10/27/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%E7%AC%AC3%E8%AE%B2%E2%80%94%E2%80%94%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E7%9A%84%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C/" title="回归分析第3讲——线性回归的假设检验"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-27</div><div class="info-item-2">回归分析第3讲——线性回归的假设检验</div></div><div class="info-2"><div class="info-item-1">一、模型检验 一旦我们完成了线性回归的参数拟合之后，就要对模型进行检验。那么为什么要进行检验？目的无非有两个：  检测模型的显著性，即模型结构是否存在，在数学上也就是验证回归系数β1,⋯ ,βp\beta_1,\cdots,\beta_pβ1​,⋯,βp​之中至少有一个系数不为0，这样模型才会有线性成分，模型结构才会成立； 检验回归系数的显著性，即到底哪些回归系数可以认为不是0的，即真正对观测值yyy有贡献的是哪些项，这样我们才能精准地找到关键特征。  那么接下来我们就从一般线性回归开始，介绍模型检验的原理和方法。 1.1 一般线性回归的检验 为了不失一般性，并且将模型显著性和系数显著性检验统一起来，我们设模型为： Y=Xn×pβ+e,e∼N(0,σ2In)Y=X_{n\times p}\beta+e,e\sim N(0,\sigma^2I_n) Y=Xn×p​β+e,e∼N(0,σ2In​) 假定rank(X)=rrank(X)=rrank(X)=r，给定已知矩阵Hm×pH_{m\times p}Hm×p​，rank(H)=mrank(H)=mrank(H)=m，那么我们的假设...</div></div></div></a><a class="pagination-related" href="/2025/10/30/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%E7%AC%AC6%E8%AE%B2%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8ER%E8%AF%AD%E8%A8%80%E8%AF%8A%E6%96%AD%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/" title="回归分析第6讲——基于R语言诊断线性回归"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-30</div><div class="info-item-2">回归分析第6讲——基于R语言诊断线性回归</div></div><div class="info-2"><div class="info-item-1">这一讲为实践内容，我们将学习如何使用R语言对已经建立的线性回归模型进行诊断。值得注意的是，模型诊断的方法很多，可用的函数也很多，所以并不局限于本讲所提供的方法。 本讲默认读者已经了解R语言的基本语法，能够在自己的电脑中成功编写和运行R脚本。 一、残差诊断 诊断模型，先看残差。对于残差诊断，我们往往从三个方面去考察：  等方差，即残差方差是否为常数； 正态性，即残差是否服从正态分布； 独立性，即各个残差之间是否独立。  1.1 等方差检验 要检验方差是否为常数，最直观的办法就是绘制残差图。绘制残差图时，要以残差值为纵坐标，但横坐标有很多选择，一般我们选择拟合值y^\hat yy^​。对于残差图来说，一般会出现下面三种形式：   最左边是正常情况，也就是残差上下左右均匀地分布在直线Residual=0Residual=0Residual=0附近，没有任何多余地趋势。 中间是异方差，也就是残差分布左右不均匀，往往成放射状或收缩状。 最右边是非线性方差，也就是残差分布上下不均匀，可能需要对响应变量进行幂次变换。  我们来看一个具体的例子。我们使用faraway包中的savings数据集，...</div></div></div></a><a class="pagination-related" href="/2025/10/31/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%E7%AC%AC7%E8%AE%B2%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8ER%E8%AF%AD%E8%A8%80%E4%BC%98%E5%8C%96%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/" title="回归分析第7讲——基于R语言优化线性回归"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-31</div><div class="info-item-2">回归分析第7讲——基于R语言优化线性回归</div></div><div class="info-2"><div class="info-item-1">这一讲为实践内容，是对回归分析第6讲的延伸，我们将学习如何使用R语言对欠佳的线性回归模型进行优化。 本讲默认读者已经了解R语言的基本语法，能够在自己的电脑中成功编写和运行R脚本。 一、残差问题优化 1.1 残差不独立的情形 残差不独立，也就是说模型的协方差阵不满足GM条件。我们假设Cov(e)=σ2ΣCov(e)=\sigma^2\SigmaCov(e)=σ2Σ。在这种情况下，我们可以选择Aitken模型来进行建模。该模型的求解使用广义最小二乘法，我们可以得到解为： β^=(XTΣ−1X)−XTΣ−1Yvar(β^)=σ2(XTΣ−1X)−\begin{aligned} \hat\beta&amp;=(X^T\Sigma^{-1}X)^-X^T\Sigma^{-1}Y\\ var(\hat\beta)&amp;=\sigma^2(X^T\Sigma^{-1}X)^- \end{aligned} β^​var(β^​)​=(XTΣ−1X)−XTΣ−1Y=σ2(XTΣ−1X)−​ 举一个实际例子。我们导入faraway包中的globwarm数据集，使用线性回归模型进行拟合： &gt;...</div></div></div></a><a class="pagination-related" href="/2025/11/05/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%E7%AC%AC9%E8%AE%B2%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8ER%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90/" title="回归分析第9讲——基于R语言实现方差分析"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-05</div><div class="info-item-2">回归分析第9讲——基于R语言实现方差分析</div></div><div class="info-2"><div class="info-item-1">这一讲为实践内容，我们将学习如何使用R语言处理模型中的哑变量，并实现方差分析。 本讲默认读者已经了解R语言的基本语法，能够在自己的电脑中成功编写和运行R脚本。 一、哑变量处理 当回归模型中出现属性变量时，我们应当考虑使用哑变量进行处理。我们来看看如何在R语言中引入哑变量。 1.1 二分类变量的哑变量处理 二分类变量，即属性变量只有两个状态，例如患病与否、质量好坏等等。我们使用faraway包中的sexab数据集进行示例，这是一个描述成年女性在儿童时期受到性别霸凌后的创伤后应激障碍（PTSD）的情况，其中ptsd列表示PTSD的值，cpa列表示身体霸凌的标准尺度值，csa列表示是否遭受过性别霸凌： &gt; data(sexab,package = &quot;faraway&quot;)&gt; head(sexab,3)       cpa     ptsd    csa1  2.04786  9.71365 Abused2  0.83895  6.16933 Abused3 -0.24139 15.15926 Abused&gt; tail(sexab,2)       cp...</div></div></div></a><a class="pagination-related" href="/2025/10/23/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%E7%AC%AC2%E8%AE%B2%E2%80%94%E2%80%94%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E5%8F%8A%E5%85%B6%E6%8B%9F%E5%90%88/" title="回归分析第2讲——线性回归及其拟合"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-23</div><div class="info-item-2">回归分析第2讲——线性回归及其拟合</div></div><div class="info-2"><div class="info-item-1">一、回归分析的概念 万事万物皆有联系。此消彼长是常态，同进同退不奇怪。如果我们想知道两个变量X,YX,YX,Y之间是否有关联，我们要怎么做呢？ 很直接的想法就是测量多组XXX和YYY的观测值，之后绘制散点图，看看随着XXX的变化，YYY有没有发生变化。如果XXX增大，YYY也增大，说明两个变量是有关联的，并且是正向的关联；如果XXX增大，YYY却减小，说明两个变量是反向的关联。 再代数一点，假设在一次实验中，我们获得了两个变量X,YX,YX,Y的nnn组观测值(xi,yi)(x_i,y_i)(xi​,yi​)，其中i=1,⋯ ,ni=1,\cdots,ni=1,⋯,n。我们希望通过这nnn组观测值来推断两个变量的关系，也就是找到这样一个关系fff，满足： Y=f(θ;X)Y=f(\theta;X) Y=f(θ;X) 其中θ\thetaθ是一个确定但未知的参数。 像这样的通过变量对应的大量观测值来推断关系fff的过程，在统计上就称为回归(Regression)。  ”回归“一词最早是由弗朗西斯·高尔顿提出的，用于描述他在优生学方面的发现。不过，现代的”回归“一词早已不等同于高尔顿所...</div></div></div></a><a class="pagination-related" href="/2025/11/06/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%E7%AC%AC10%E8%AE%B2%E2%80%94%E2%80%94%E5%B9%BF%E4%B9%89%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E5%AF%BC%E8%AE%BA/" title="回归分析第10讲——广义线性回归导论"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-06</div><div class="info-item-2">回归分析第10讲——广义线性回归导论</div></div><div class="info-2"><div class="info-item-1">一、广义线性回归的概念 通过前面9讲的学习，我们了解了线性回归模型的结构，以及如何估计参数和假设检验。总结来说，线性回归结构的基本假定是，响应变量的期望值可以由自变量的线性预测子得到，即满足： EY=XβEY=X\beta EY=Xβ 在现实应用当中，要满足这个假定其实很苛刻。一方面，某组自变量对应的响应变量取值的分布不一定是正态分布，可以是偏态的、拖尾的；另一方面，响应变量的取值可以是离散的。在这些情况下，线性回归模型就不再适用了。那应该如何处理呢？ 既然是响应变量的问题，那么我们可以考虑，保留自变量的线性结构，但是和响应变量连接时套上一层函数进行转换，也就是满足： g(EY)=Xβg(EY)=X\beta g(EY)=Xβ 这里的g()g()g()被称为联系函数(link function)，是已知且单调光滑的。联系函数，顾名思义，就是通过一个函数把响应变量和线性预测子联系起来，这样既处理了响应变量，也保留了线性成分。 显然，如果我们定义h=g−1(t)h=g^{-1}(t)h=g−1(t)，那么就有EY=h(Xβ)EY=h(X\beta)EY=h(Xβ)。不难猜测，如果g(...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Redamancy</div><div class="author-info-description">做一颗最稳固的螺丝钉</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/cien-su"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/cien-su" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:zhangyu.educ@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">新人博主，请多关照~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">一、线性回归的建立与解读</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E7%A4%BA%E4%BE%8B%E6%95%B0%E6%8D%AE%E9%9B%86%E4%BB%8B%E7%BB%8D"><span class="toc-text">1.1 示例数据集介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E5%BB%BA%E7%AB%8B%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B"><span class="toc-text">1.2 建立线性回归模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E6%A8%A1%E5%9E%8B%E6%8B%9F%E5%90%88%E5%8F%82%E6%95%B0%E8%A7%A3%E8%AF%BB"><span class="toc-text">1.3 模型拟合参数解读</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-%E5%85%B6%E4%BB%96%E8%BE%93%E5%87%BA%E8%A7%A3%E8%AF%BB"><span class="toc-text">1.4 其他输出解读</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">二、线性回归的假设检验与预测</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E6%A8%A1%E5%9E%8B%E6%98%BE%E8%91%97%E6%80%A7%E6%A3%80%E9%AA%8C"><span class="toc-text">2.1 模型显著性检验</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E5%9B%9E%E5%BD%92%E7%B3%BB%E6%95%B0%E6%98%BE%E8%91%97%E6%80%A7%E6%A3%80%E9%AA%8C"><span class="toc-text">2.2 回归系数显著性检验</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E5%9B%9E%E5%BD%92%E7%B3%BB%E6%95%B0%E7%9A%84%E7%BD%AE%E4%BF%A1%E5%8C%BA%E9%97%B4"><span class="toc-text">2.3 回归系数的置信区间</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E7%9A%84%E9%A2%84%E6%B5%8B"><span class="toc-text">2.4 线性回归的预测</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/20/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%E7%AC%AC14%E8%AE%B2%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8ER%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E6%B3%8A%E6%9D%BE%E5%9B%9E%E5%BD%92/" title="回归分析第14讲——基于R语言实现泊松回归">回归分析第14讲——基于R语言实现泊松回归</a><time datetime="2025-11-20T08:06:03.000Z" title="发表于 2025-11-20 16:06:03">2025-11-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/18/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%E7%AC%AC13%E8%AE%B2%E2%80%94%E2%80%94%E6%B3%8A%E6%9D%BE%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B/" title="回归分析第13讲——泊松回归模型">回归分析第13讲——泊松回归模型</a><time datetime="2025-11-18T02:13:49.000Z" title="发表于 2025-11-18 10:13:49">2025-11-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/17/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%E7%AC%AC12%E8%AE%B2%E2%80%94%E2%80%94%E5%9F%BA%E4%BA%8ER%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/" title="回归分析第12讲——基于R语言实现逻辑回归">回归分析第12讲——基于R语言实现逻辑回归</a><time datetime="2025-11-17T02:47:39.000Z" title="发表于 2025-11-17 10:47:39">2025-11-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/10/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%E7%AC%AC11%E8%AE%B2%E2%80%94%E2%80%94%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92%E6%A8%A1%E5%9E%8B/" title="回归分析第11讲——逻辑回归模型">回归分析第11讲——逻辑回归模型</a><time datetime="2025-11-10T02:14:27.000Z" title="发表于 2025-11-10 10:14:27">2025-11-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/06/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90%E7%AC%AC10%E8%AE%B2%E2%80%94%E2%80%94%E5%B9%BF%E4%B9%89%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E5%AF%BC%E8%AE%BA/" title="回归分析第10讲——广义线性回归导论">回归分析第10讲——广义线性回归导论</a><time datetime="2025-11-06T02:03:33.000Z" title="发表于 2025-11-06 10:03:33">2025-11-06</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By Redamancy</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.0.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.1</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.1"></script><script src="/js/main.js?v=5.5.1"></script><div class="js-pjax"><script>(async () => {
  const showKatex = () => {
    document.querySelectorAll('#article-container .katex').forEach(el => el.classList.add('katex-show'))
  }

  if (!window.katex_js_css) {
    window.katex_js_css = true
    await btf.getCSS('https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css')
    if (true) {
      await btf.getScript('https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/copy-tex.min.js')
    }
  }

  showKatex()
})()</script></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索文章" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.1"></script></div></div></body></html>